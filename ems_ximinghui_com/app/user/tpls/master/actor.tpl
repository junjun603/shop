{x2;if:!$userhash}{x2;include:header}<body><style>	.waiting{		position: fixed;		top:0;		left:0;		right:0;		bottom:0;		background: rgba(0, 0, 0, 0.6);		display: none;		z-index: 998;	}	.batchDiv{		position: absolute;		z-index: 1999;		top: 10%;		left: 30%;		background: #fff;		min-width:400px;	}</style>{x2;include:nav}<div class="container-fluid">	<div class="row-fluid">		<div class="main">			<div class="col-xs-2" style="padding-top:10px;margin-bottom:0px;">				{x2;include:menu}			</div>			<div class="col-xs-10" id="datacontent">{x2;endif}				<div class="box itembox" style="margin-bottom:0px;border-bottom:1px solid #CCCCCC;">					<div class="col-xs-12">						<ol class="breadcrumb">							<li><a href="index.php?{x2;$_app}-master">{x2;$apps[$_app]['appname']}</a></li>							<li class="active">角色管理</li>						</ol>					</div>				</div>				<div class="box itembox" style="padding-top:10px;margin-bottom:0px;">					<h4 class="title" style="padding:10px;">						角色列表						<a class="pull-right btn btn-primary" style="margin-left:10px;" href="#" onclick="batchRole()">csv批量添加角色</a>						<a class="pull-right btn btn-primary" href="index.php?user-master-actor-add">添加角色</a>					</h4>					<table class="table table-hover table-bordered">						<thead>							<tr class="info">								<th>ID</th>								<th>角色名</th>								<th>默认角色</th>								<th>绑定模型</th>								<th>角色描述</th>								<th>操作</th>							</tr>						</thead>						<tbody>							{x2;tree:$actors['data'],group,gid}							<tr>								<td>{x2;v:group['groupid']}</td>								<td>{x2;v:group['groupname']}</td>								<td>{x2;if:v:group['groupdefault']}<a class="glyphicon glyphicon-ok"></a>{x2;else}<a class="glyphicon glyphicon-remove ajax" href="index.php?user-master-actor-selectactor&groupid={x2;v:group['groupid']}&page={x2;$page}{x2;$u}"></a>{x2;endif}</td>								<td>{x2;$modules[v:group['groupmoduleid']]['modulename']}</td>								<td>{x2;v:group['groupdescribe']}</td>								<td>									<div class="btn-group">										<a class="btn" href="index.php?user-master-actor-modifyactor&groupid={x2;v:group['groupid']}&page={x2;$page}{x2;$u}" title="修改角色"><em class="glyphicon glyphicon-edit"></em></a>										<a msg="删除后不可恢复，您确定要进行此操作吗？" class="btn confirm" href="index.php?user-master-actor-delactor&groupid={x2;v:group['groupid']}&page={x2;$page}{x2;$u}" title="删除角色"><em class="glyphicon glyphicon-remove"></em></a>									</div>								</td>							</tr>							{x2;endtree}						</tbody>					</table>					<ul class="pagination pagination-right">						{x2;$actors['pages']}					</ul>				</div>			</div>{x2;if:!$userhash}		</div>	</div></div><div id="waiting" class="waiting"></div><!-- 模态框（Modal） --><div class="modal" id="selfModal">	<div class="modal-dialog">		<div class="modal-content">			<div class="modal-header">				<button type="button" class="close closeModal">&times;</button>				<h4 class="modal-title" id="myModalLabel"><label for="">示范格式</label><br> <span>第一列：角色名 第二列：模型值(12)  &nbsp;&nbsp;第三列：描述</span></h4>			</div>			<div class="modal-body"></div>		</div>	</div></div><div class="modal-backdrop fade in coverLayer" style="display:none;"></div>{x2;include:footer}</body><script>    function batchRole(){        $('#selfModal').css("display","block")        $('.coverLayer').css("display","block")        var  str = '<div class="">';        str += '<input type="file" id="uploadform" accept=".csv">';        str += '</div>';        str += '<div class="form-group" style="margin-top:15px;margin-bottom:0px;">';        str += '<button type="submit" class="btn btn-primary import_excel">导入</button>';        str += '</div>';        $('.modal-body').html(str);	}    // 关闭按钮操作    $(document).on('click','.closeModal',function(){        $('#selfModal').css("display","none")        $('.coverLayer').css("display","none")    })    //导入点击    $(document).on('click','.import_excel',function (){        var formData = new FormData();        formData.append("myfile", document.getElementById("uploadform").files[0]);        $.ajax({            url: "index.php?user-master-actor-batchRole",            type: "POST",            data: formData,            contentType: false,            processData: false,            success: function(data) {               var jsonData = JSON.parse(data);               if(jsonData['status']==1) toast('导入成功');                else if(jsonData['status']==2){                    toast('你没有选择任何文件');               }else{                   toast('导入失败');                }               setInterval(function() {                   window.location.reload();                   },800)            },            error: function() {                alert('网络错误！');            }        });    });    function toast(txt, fun) { //吐丝提示        $('.toast').remove();        var div = $('<div style="background: #fff;max-width: 85%;min-height: 77px;min-width: 270px;position: absolute;left: -1000px;top: -1000px;text-align: center;border-radius:10px;"><span style="color: #333;line-height: 77px;font-size: 23px;">' + txt + '</span></div>');        $('body').append(div);        div.css('zIndex', 9999999);        div.css('left', parseInt(($(window).width() - div.width()) / 2));        var top = parseInt($(window).scrollTop() + ($(window).height() - div.height()) / 2);        div.css('top', top);        setTimeout(function () {            div.remove();            if (fun) {                fun();            }        }, 2000);    }</script></html>{x2;endif}